name: Copy XCFramework from Private to Public Repo

on:
  workflow_dispatch:  # Manually triggered for demonstration; you can customize this trigger

jobs:
  copy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout public repository
        uses: actions/checkout@v2
        with:
          repository: vivektechyogi/arithmetic-operations
          token: ${{ secrets.GITHUB_TOKEN }}
          path: public-repo

      - name: Clone private repository
        env:
          PAT: ${{ secrets.PAT }}
        run: |
          git clone https://github-actions:${{ secrets.PAT }}@github.com/SwiftPackageManagerDemo/Addition.git private-repo
          cd private-repo
          git checkout main

      - name: Copy XCFramework to Public Repo
        run: |
          cp private-repo/Framework/Addition.xcframework.zip public-repo/Framework/

      - name: Configure Git
        run: |
          cd public-repo
          git config --global user.email "you@example.com"
          git config --global user.name "Your Name"

      - name: Commit and Push to Public Repo
        env:
          PAT: ${{ secrets.PAT }}
        run: |
          cd public-repo
          git add Framework/Addition.xcframework.zip
          git commit -m "Add Addition.xcframework.zip"
          git push https://github-actions:${{ secrets.PAT }}@github.com/vivektechyogi/arithmetic-operations.git main
